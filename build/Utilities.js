"use strict";

Object.defineProperty(exports, "__esModule", {
  value: true
});
let Utilities = {};
const globalType = typeof window === "undefined" ? global : window;

Utilities.getViewer = function () {
  return new Promise((resolve, reject) => {
    if (globalType.v === "undefined") {
      let interval = setInterval(() => {
        if (globalType.v !== "undefined") {
          resolve(globalType.v);
          clearInterval(interval);
        }
      }, 500);
    } else resolve(globalType.v);
  });
};

Utilities.promiseGetProperties = function (_dbId) {
  return new Promise(resolve => {
    Utilities.getViewer().then(viewer => {
      viewer.getProperties(_dbId, resolve);
    });
  });
};

Utilities.promiseGetExternalIdMapping = function (_externalId) {
  return new Promise(resolve => {
    Utilities.getViewer().then(viewer => {
      viewer.model.getExternalIdMapping(res => {
        resolve(res[_externalId]);
      });
    });
  });
};

Utilities.promiseLoad = function (_ptr) {
  return new Promise(resolve => {
    _ptr.load(resolve);
  });
};

Utilities.getExternalId = async function (_dbId) {
  let properties = await Utilities.promiseGetProperties(_dbId);
  return properties.externalId;
};

Utilities.getDbIdByExternalId = async function (_externalId) {
  let dbid = await Utilities.promiseGetExternalIdMapping(_externalId);
  return dbid;
};

Utilities.arraysEqual = function (arrayA, arrayB) {
  if (arrayA === arrayB) return true;
  if (arrayA == null || arrayB == null) return false;
  if (arrayA.length != arrayB.length) return false;
  arrayA.sort();
  console.log(arrayA);

  arrayB.sort();
  for (var i = 0; i < arrayA.length; ++i) {
    if (arrayA[i] !== arrayB[i]) return false;
  }
  return true;
};

Utilities.contains = function (_list, _node) {
  for (let index = 0; index < _list.length; index++) {
    const element = _list[index];
    if (element.id.get() == _node.id.get()) return true;
  }
  return false;
};

Utilities.include = function (arr, obj) {
  return arr.indexOf(obj) != -1;
};

Utilities.getIndex = function (arr, obj) {
  return arr.indexOf(obj);
};

Utilities.getIds = function (array) {
  let res = [];
  for (let index = 0; index < array.length; index++) {
    res.push(array[index].id.get());
  }
  return res;
};
// Utilities.addNotExisting = function(arr, obj) {
//   return (arr.indexOf(obj));
// }

Utilities.concat = function (listA, listB) {
  let res = [];
  for (let index = 0; index < listA.length; index++) {
    res.push(listA[index]);
  }
  for (let index = 0; index < listB.length; index++) {
    res.push(listB[index]);
  }
  return res;
};

Utilities.allButMeById = function (_list) {
  let res = [];
  for (let index = 0; index < _list.length; index++) {
    const node = _list[index];
    if (node.id.get() != this.id.get()) {
      res.push(node);
    }
    return res;
  }
};

Utilities.guid = function (_constructor) {
  return _constructor + "-" + this.s4() + this.s4() + "-" + this.s4() + "-" + this.s4() + "-" + this.s4() + "-" + this.s4() + this.s4() + this.s4() + "-" + Date.now().toString(16);
};

Utilities.s4 = function () {
  return Math.floor((1 + Math.random()) * 0x10000).toString(16).substring(1);
};

exports.Utilities = Utilities;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uL3NyYy9VdGlsaXRpZXMuanMiXSwibmFtZXMiOlsiVXRpbGl0aWVzIiwiZ2xvYmFsVHlwZSIsIndpbmRvdyIsImdsb2JhbCIsImdldFZpZXdlciIsIlByb21pc2UiLCJyZXNvbHZlIiwicmVqZWN0IiwidiIsImludGVydmFsIiwic2V0SW50ZXJ2YWwiLCJjbGVhckludGVydmFsIiwicHJvbWlzZUdldFByb3BlcnRpZXMiLCJfZGJJZCIsInRoZW4iLCJ2aWV3ZXIiLCJnZXRQcm9wZXJ0aWVzIiwicHJvbWlzZUdldEV4dGVybmFsSWRNYXBwaW5nIiwiX2V4dGVybmFsSWQiLCJtb2RlbCIsImdldEV4dGVybmFsSWRNYXBwaW5nIiwicmVzIiwicHJvbWlzZUxvYWQiLCJfcHRyIiwibG9hZCIsImdldEV4dGVybmFsSWQiLCJwcm9wZXJ0aWVzIiwiZXh0ZXJuYWxJZCIsImdldERiSWRCeUV4dGVybmFsSWQiLCJkYmlkIiwiYXJyYXlzRXF1YWwiLCJhcnJheUEiLCJhcnJheUIiLCJsZW5ndGgiLCJzb3J0IiwiY29uc29sZSIsImxvZyIsImkiLCJjb250YWlucyIsIl9saXN0IiwiX25vZGUiLCJpbmRleCIsImVsZW1lbnQiLCJpZCIsImdldCIsImluY2x1ZGUiLCJhcnIiLCJvYmoiLCJpbmRleE9mIiwiZ2V0SW5kZXgiLCJnZXRJZHMiLCJhcnJheSIsInB1c2giLCJjb25jYXQiLCJsaXN0QSIsImxpc3RCIiwiYWxsQnV0TWVCeUlkIiwibm9kZSIsImd1aWQiLCJfY29uc3RydWN0b3IiLCJzNCIsIkRhdGUiLCJub3ciLCJ0b1N0cmluZyIsIk1hdGgiLCJmbG9vciIsInJhbmRvbSIsInN1YnN0cmluZyJdLCJtYXBwaW5ncyI6Ijs7Ozs7QUFBQSxJQUFJQSxZQUFZLEVBQWhCO0FBQ0EsTUFBTUMsYUFBYSxPQUFPQyxNQUFQLEtBQWtCLFdBQWxCLEdBQWdDQyxNQUFoQyxHQUF5Q0QsTUFBNUQ7O0FBRUFGLFVBQVVJLFNBQVYsR0FBc0IsWUFBVztBQUMvQixTQUFPLElB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TSxFQUFWO0FBQ0EsT0FBSyxJQUFJb0IsUUFBUSxDQUFqQixFQUFvQkEsUUFBUUYsTUFBTU4sTUFBbEMsRUFBMENRLE9BQTFDLEVBQW1EO0FBQ2pELFVBQU1nQixPQUFPbEIsTUFBTUUsS0FBTixDQUFiO0FBQ0EsUUFBSWdCLEtBQUtkLEVBQUwsQ0FBUUMsR0FBUixNQUFpQixLQUFLRCxFQUFMLENBQVFDLEdBQVIsRUFBckIsRUFBb0M7QUFDbEN2QixVQUFJK0IsSUFBSixDQUFTSyxJQUFUO0FBQ0Q7QUFDRCxXQUFPcEMsR0FBUDtBQUNEO0FBQ0YsQ0FURDs7QUFXQXJCLFVBQVUwRCxJQUFWLEdBQWlCLFVBQVNDLFlBQVQsRUFBdUI7QUFDdEMsU0FDRUEsZUFDQSxHQURBLEdBRUEsS0FBS0MsRUFBTCxFQUZBLEdBR0EsS0FBS0EsRUFBTCxFQUhBLEdBSUEsR0FKQSxHQUtBLEtBQUtBLEVBQUwsRUFMQSxHQU1BLEdBTkEsR0FPQSxLQUFLQSxFQUFMLEVBUEEsR0FRQSxHQVJBLEdBU0EsS0FBS0EsRUFBTCxFQVRBLEdBVUEsR0FWQSxHQVdBLEtBQUtBLEVBQUwsRUFYQSxHQVlBLEtBQUtBLEVBQUwsRUFaQSxHQWFBLEtBQUtBLEVBQUwsRUFiQSxHQWNBLEdBZEEsR0FlQUMsS0FBS0MsR0FBTCxHQUFXQyxRQUFYLENBQW9CLEVBQXBCLENBaEJGO0FBa0JELENBbkJEOztBQXFCQS9ELFVBQVU0RCxFQUFWLEdBQWUsWUFBVztBQUN4QixTQUFPSSxLQUFLQyxLQUFMLENBQVcsQ0FBQyxJQUFJRCxLQUFLRSxNQUFMLEVBQUwsSUFBc0IsT0FBakMsRUFDSkgsUUFESSxDQUNLLEVBREwsRUFFSkksU0FGSSxDQUVNLENBRk4sQ0FBUDtBQUdELENBSkQ7O1FBU0VuRSxTLEdBQUFBLFMiLCJmaWxlIjoiVXRpbGl0aWVzLmpzIiwic291cmNlc0NvbnRlbnQiOlsibGV0IFV0aWxpdGllcyA9IHt9XG5jb25zdCBnbG9iYWxUeXBlID0gdHlwZW9mIHdpbmRvdyA9PT0gXCJ1bmRlZmluZWRcIiA/IGdsb2JhbCA6IHdpbmRvdztcblxuVXRpbGl0aWVzLmdldFZpZXdlciA9IGZ1bmN0aW9uKCkge1xuICByZXR1cm4gbmV3IFByb21pc2UoKHJlc29sdmUsIHJlamVjdCkgPT4ge1xuICAgIGlmIChnbG9iYWxUeXBlLnYgPT09IFwidW5kZWZpbmVkXCIpIHtcbiAgICAgIGxldCBpbnRlcnZhbCA9IHNldEludGVydmFsKCgpID0+IHtcbiAgICAgICAgaWYgKGdsb2JhbFR5cGUudiAhPT0gXCJ1bmRlZmluZWRcIikge1xuICAgICAgICAgIHJlc29sdmUoZ2xvYmFsVHlwZS52KVxuICAgICAgICAgIGNsZWFySW50ZXJ2YWwoaW50ZXJ2YWwpXG4gICAgICAgIH1cbiAgICAgIH0sIDUwMCk7XG4gICAgfSBlbHNlIHJlc29sdmUoZ2xvYmFsVHlwZS52KVxuICB9KVxufVxuXG5VdGlsaXRpZXMucHJvbWlzZUdldFByb3BlcnRpZXMgPSBmdW5jdGlvbihfZGJJZCkge1xuICByZXR1cm4gbmV3IFByb21pc2UocmVzb2x2ZSA9PiB7XG4gICAgVXRpbGl0aWVzLmdldFZpZXdlcigpLnRoZW4odmlld2VyID0+IHtcbiAgICAgIHZpZXdlci5nZXRQcm9wZXJ0aWVzKF9kYklkLCByZXNvbHZlKTtcbiAgICB9KVxuICB9KTtcbn1cblxuVXRpbGl0aWVzLnByb21pc2VHZXRFeHRlcm5hbElkTWFwcGluZyA9IGZ1bmN0aW9uKF9leHRlcm5hbElkKSB7XG4gIHJldHVybiBuZXcgUHJvbWlzZShyZXNvbHZlID0+IHtcbiAgICBVdGlsaXRpZXMuZ2V0Vmlld2VyKCkudGhlbih2aWV3ZXIgPT4ge1xuICAgICAgdmlld2VyLm1vZGVsLmdldEV4dGVybmFsSWRNYXBwaW5nKHJlcyA9PiB7XG4gICAgICAgIHJlc29sdmUocmVzW19leHRlcm5hbElkXSlcbiAgICAgIH0pO1xuICAgIH0pXG4gIH0pO1xufVxuXG5VdGlsaXRpZXMucHJvbWlzZUxvYWQgPSBmdW5jdGlvbihfcHRyKSB7XG4gIHJldHVybiBuZXcgUHJvbWlzZShyZXNvbHZlID0+IHtcbiAgICBfcHRyLmxvYWQocmVzb2x2ZSk7XG4gIH0pO1xufVxuXG5cblxuXG5VdGlsaXRpZXMuZ2V0RXh0ZXJuYWxJZCA9IGFzeW5jIGZ1bmN0aW9uKF9kYklkKSB7XG4gIGxldCBwcm9wZXJ0aWVzID0gYXdhaXQgVXRpbGl0aWVzLnByb21pc2VHZXRQcm9wZXJ0aWVzKF9kYklkKTtcbiAgcmV0dXJuIHByb3BlcnRpZXMuZXh0ZXJuYWxJZDtcbn1cblxuVXRpbGl0aWVzLmdldERiSWRCeUV4dGVybmFsSWQgPSBhc3luYyBmdW5jdGlvbihfZXh0ZXJuYWxJZCkge1xuICBsZXQgZGJpZCA9IGF3YWl0IFV0aWxpdGllcy5wcm9taXNlR2V0RXh0ZXJuYWxJZE1hcHBpbmcoX2V4dGVybmFsSWQpO1xuICByZXR1cm4gZGJpZDtcbn1cblxuVXRpbGl0aWVzLmFycmF5c0VxdWFsID0gZnVuY3Rpb24oYXJyYXlBLCBhcnJheUIpIHtcbiAgaWYgKGFycmF5QSA9PT0gYXJyYXlCKSByZXR1cm4gdHJ1ZTtcbiAgaWYgKGFycmF5QSA9PSBudWxsIHx8IGFycmF5QiA9PSBudWxsKSByZXR1cm4gZmFsc2U7XG4gIGlmIChhcnJheUEubGVuZ3RoICE9IGFycmF5Qi5sZW5ndGgpIHJldHVybiBmYWxzZTtcbiAgYXJyYXlBLnNvcnQoKTtcbiAgY29uc29sZS5sb2coYXJyYXlBKTtcblxuICBhcnJheUIuc29ydCgpO1xuICBmb3IgKHZhciBpID0gMDsgaSA8IGFycmF5QS5sZW5ndGg7ICsraSkge1xuICAgIGlmIChhcnJheUFbaV0gIT09IGFycmF5QltpXSkgcmV0dXJuIGZhbHNlO1xuICB9XG4gIHJldHVybiB0cnVlO1xufVxuXG5VdGlsaXRpZXMuY29udGFpbnMgPSBmdW5jdGlvbihfbGlzdCwgX25vZGUpIHtcbiAgZm9yIChsZXQgaW5kZXggPSAwOyBpbmRleCA8IF9saXN0Lmxlbmd0aDsgaW5kZXgrKykge1xuICAgIGNvbnN0IGVsZW1lbnQgPSBfbGlzdFtpbmRleF07XG4gICAgaWYgKGVsZW1lbnQuaWQuZ2V0KCkgPT0gX25vZGUuaWQuZ2V0KCkpXG4gICAgICByZXR1cm4gdHJ1ZVxuICB9XG4gIHJldHVybiBmYWxzZVxufVxuXG5VdGlsaXRpZXMuaW5jbHVkZSA9IGZ1bmN0aW9uKGFyciwgb2JqKSB7XG4gIHJldHVybiAoYXJyLmluZGV4T2Yob2JqKSAhPSAtMSk7XG59XG5cblV0aWxpdGllcy5nZXRJbmRleCA9IGZ1bmN0aW9uKGFyciwgb2JqKSB7XG4gIHJldHVybiAoYXJyLmluZGV4T2Yob2JqKSk7XG59XG5cblV0aWxpdGllcy5nZXRJZHMgPSBmdW5jdGlvbihhcnJheSkge1xuICBsZXQgcmVzID0gW11cbiAgZm9yIChsZXQgaW5kZXggPSAwOyBpbmRleCA8IGFycmF5Lmxlbmd0aDsgaW5kZXgrKykge1xuICAgIHJlcy5wdXNoKGFycmF5W2luZGV4XS5pZC5nZXQoKSlcbiAgfVxuICByZXR1cm4gcmVzO1xufVxuLy8gVXRpbGl0aWVzLmFkZE5vdEV4aXN0aW5nID0gZnVuY3Rpb24oYXJyLCBvYmopIHtcbi8vICAgcmV0dXJuIChhcnIuaW5kZXhPZihvYmopKTtcbi8vIH1cblxuVXRpbGl0aWVzLmNvbmNhdCA9IGZ1bmN0aW9uKGxpc3RBLCBsaXN0Qikge1xuICBsZXQgcmVzID0gW11cbiAgZm9yIChsZXQgaW5kZXggPSAwOyBpbmRleCA8IGxpc3RBLmxlbmd0aDsgaW5kZXgrKykge1xuICAgIHJlcy5wdXNoKGxpc3RBW2luZGV4XSlcbiAgfVxuICBmb3IgKGxldCBpbmRleCA9IDA7IGluZGV4IDwgbGlzdEIubGVuZ3RoOyBpbmRleCsrKSB7XG4gICAgcmVzLnB1c2gobGlzdEJbaW5kZXhdKVxuICB9XG4gIHJldHVybiByZXM7XG59XG5cblV0aWxpdGllcy5hbGxCdXRNZUJ5SWQgPSBmdW5jdGlvbihfbGlzdCkge1xuICBsZXQgcmVzID0gW107XG4gIGZvciAobGV0IGluZGV4ID0gMDsgaW5kZXggPCBfbGlzdC5sZW5ndGg7IGluZGV4KyspIHtcbiAgICBjb25zdCBub2RlID0gX2xpc3RbaW5kZXhdO1xuICAgIGlmIChub2RlLmlkLmdldCgpICE9IHRoaXMuaWQuZ2V0KCkpIHtcbiAgICAgIHJlcy5wdXNoKG5vZGUpO1xuICAgIH1cbiAgICByZXR1cm4gcmVzO1xuICB9XG59XG5cblV0aWxpdGllcy5ndWlkID0gZnVuY3Rpb24oX2NvbnN0cnVjdG9yKSB7XG4gIHJldHVybiAoXG4gICAgX2NvbnN0cnVjdG9yICtcbiAgICBcIi1cIiArXG4gICAgdGhpcy5zNCgpICtcbiAgICB0aGlzLnM0KCkgK1xuICAgIFwiLVwiICtcbiAgICB0aGlzLnM0KCkgK1xuICAgIFwiLVwiICtcbiAgICB0aGlzLnM0KCkgK1xuICAgIFwiLVwiICtcbiAgICB0aGlzLnM0KCkgK1xuICAgIFwiLVwiICtcbiAgICB0aGlzLnM0KCkgK1xuICAgIHRoaXMuczQoKSArXG4gICAgdGhpcy5zNCgpICtcbiAgICBcIi1cIiArXG4gICAgRGF0ZS5ub3coKS50b1N0cmluZygxNilcbiAgKTtcbn1cblxuVXRpbGl0aWVzLnM0ID0gZnVuY3Rpb24oKSB7XG4gIHJldHVybiBNYXRoLmZsb29yKCgxICsgTWF0aC5yYW5kb20oKSkgKiAweDEwMDAwKVxuICAgIC50b1N0cmluZygxNilcbiAgICAuc3Vic3RyaW5nKDEpO1xufVxuXG5cblxuZXhwb3J0IHtcbiAgVXRpbGl0aWVzXG59Il19