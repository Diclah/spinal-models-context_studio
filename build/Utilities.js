"use strict";

Object.defineProperty(exports, "__esModule", {
  value: true
});
let Utilities = {};
const globalType = typeof window === "undefined" ? global : window;

Utilities.getViewer = function () {
  return new Promise((resolve, reject) => {
    if (globalType.v === "undefined") {
      let interval = setInterval(() => {
        if (globalType.v !== "undefined") {
          resolve(globalType.v);
          clearInterval(interval);
        }
      }, 500);
    } else resolve(globalType.v);
  });
};

Utilities.promiseGetProperties = function (_dbId) {
  return new Promise(resolve => {
    Utilities.getViewer().then(viewer => {
      viewer.getProperties(_dbId, resolve);
    });
  });
};

Utilities.promiseGetExternalIdMapping = function (_externalId) {
  return new Promise(resolve => {
    Utilities.getViewer().then(viewer => {
      viewer.model.getExternalIdMapping(res => {
        resolve(res[_externalId]);
      });
    });
  });
};

Utilities.promiseLoad = function (_ptr) {
  return new Promise(resolve => {
    _ptr.load(resolve);
  });
};

Utilities.getExternalId = async function (_dbId) {
  let properties = await Utilities.promiseGetProperties(_dbId);
  return properties.externalId;
};

Utilities.getDbIdByExternalId = async function (_externalId) {
  let dbid = await Utilities.promiseGetExternalIdMapping(_externalId);
  return dbid;
};

Utilities.arraysEqual = function (arrayA, arrayB) {
  if (arrayA === arrayB) return true;
  if (arrayA == null || arrayB == null) return false;
  if (arrayA.length != arrayB.length) return false;
  arrayA.sort();
  console.log(arrayA);

  arrayB.sort();
  for (var i = 0; i < arrayA.length; ++i) {
    if (arrayA[i] !== arrayB[i]) return false;
  }
  return true;
};

// Utilities.containsLstById = function(_list, _node) {
//   for (let index = 0; index < _list.length; index++) {
//     const element = _list[index];
//     if (element.id.get() == _node.id.get())
//       return true
//   }
//   return false
// }

Utilities.containsLstModel = function (_list, _model) {
  for (let index = 0; index < _list.length; index++) {
    const element = _list[index];
    if (element.get() == _model.get()) return true;
  }
  return false;
};

Utilities.containsLst = function (_list, _element) {
  for (let index = 0; index < _list.length; index++) {
    const element = _list[index];
    if (element.get() == _element) return true;
  }
  return false;
};

Utilities.include = function (arr, obj) {
  return arr.indexOf(obj) != -1;
};

Utilities.getIndex = function (arr, obj) {
  return arr.indexOf(obj);
};

Utilities.getIds = function (array) {
  let res = [];
  for (let index = 0; index < array.length; index++) {
    res.push(array[index].id.get());
  }
  return res;
};
// Utilities.addNotExisting = function(arr, obj) {
//   return (arr.indexOf(obj));
// }

Utilities.concat = function (listA, listB) {
  let res = [];
  for (let index = 0; index < listA.length; index++) {
    res.push(listA[index]);
  }
  for (let index = 0; index < listB.length; index++) {
    res.push(listB[index]);
  }
  return res;
};

Utilities.allButMeById = function (_list) {
  let res = [];
  for (let index = 0; index < _list.length; index++) {
    const node = _list[index];
    if (node.id.get() != this.id.get()) {
      res.push(node);
    }
    return res;
  }
};

Utilities.guid = function (_constructor) {
  return _constructor + "-" + this.s4() + this.s4() + "-" + this.s4() + "-" + this.s4() + "-" + this.s4() + "-" + this.s4() + this.s4() + this.s4() + "-" + Date.now().toString(16);
};

Utilities.s4 = function () {
  return Math.floor((1 + Math.random()) * 0x10000).toString(16).substring(1);
};

Utilities.putOnTopLst = function (lst, elementB) {
  lst.remove_ref(elementB);
  lst.unshift(elementB);
  // for (let index = 0; index < lst.length; index++) {
  //   const element = lst[index];
  //   if (element.id.get() === elementB.id.get()) {
  //     lst.remove(index);
  //   }

  // }
};

exports.Utilities = Utilities;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uL3NyYy9VdGlsaXRpZXMuanMiXSwibmFtZXMiOlsiVXRpbGl0aWVzIiwiZ2xvYmFsVHlwZSIsIndpbmRvdyIsImdsb2JhbCIsImdldFZpZXdlciIsIlByb21pc2UiLCJyZXNvbHZlIiwicmVqZWN0IiwidiIsImludGVydmFsIiwic2V0SW50ZXJ2YWwiLCJjbGVhckludGVydmFsIiwicHJvbWlzZUdldFByb3BlcnRpZXMiLCJfZGJJZCIsInRoZW4iLCJ2aWV3ZXIiLCJnZXRQcm9wZXJ0aWVzIiwicHJvbWlzZUdldEV4dGVybmFsSWRNYXBwaW5nIiwiX2V4dGVybmFsSWQiLCJtb2RlbCIsImdldEV4dGVybmFsSWRNYXBwaW5nIiwicmVzIiwicHJvbWlzZUxvYWQiLCJfcHRyIiwibG9hZCIsImdldEV4dGVybmFsSWQiLCJwcm9wZXJ0aWVzIiwiZXh0ZXJuYWxJZCIsImdldERiSWRCeUV4dGVybmFsSWQiLCJkYmlkIiwiYXJyYXlzRXF1YWwiLCJhcnJheUEiLCJhcnJheUIiLCJsZW5ndGgiLCJzb3J0IiwiY29uc29sZSIsImxvZyIsImkiLCJjb250YWluc0xzdE1vZGVsIiwiX2xpc3QiLCJfbW9kZWwiLCJpbmRleCIsImVsZW1lbnQiLCJnZXQiLCJjb250YWluc0xzdCIsIl9lbGVtZW50IiwiaW5jbHVkZSIsImFyciIsIm9iaiIsImluZGV4T2YiLCJnZXRJbmRleCIsImdldElkcyIsImFycmF5IiwicHVzaCIsImlkIiwiY29uY2F0IiwibGlzdEEiLCJsaXN0QiIsImFsbEJ1dE1lQnlJZCIsIm5vZGUiLCJndWlkIiwiX2NvbnN0cnVjdG9yIiwiczQiLCJEYXRlIiwibm93IiwidG9TdHJpbmciLCJNYXRoIiwiZmxvb3IiLCJyYW5kb20iLCJzdWJzdHJpbmciLCJwdXRPblRvcExzdCIsImxzdCIsImVsZW1lbnRCIiwicmVtb3ZlX3JlZiIsInVuc2hpZnQiXSwibWFwcGluZ3MiOiI7Ozs7O0FBQUEsSUFBSUEsWUFBWSxFQUFoQjtBQUNBLE1BQU1DLGFBQWEsT0FB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QUFLQyxHQUFMLEdBQVdDLFFBQVgsQ0FBb0IsRUFBcEIsQ0FoQkY7QUFrQkQsQ0FuQkQ7O0FBcUJBakUsVUFBVThELEVBQVYsR0FBZSxZQUFXO0FBQ3hCLFNBQU9JLEtBQUtDLEtBQUwsQ0FBVyxDQUFDLElBQUlELEtBQUtFLE1BQUwsRUFBTCxJQUFzQixPQUFqQyxFQUNKSCxRQURJLENBQ0ssRUFETCxFQUVKSSxTQUZJLENBRU0sQ0FGTixDQUFQO0FBR0QsQ0FKRDs7QUFNQXJFLFVBQVVzRSxXQUFWLEdBQXdCLFVBQVNDLEdBQVQsRUFBY0MsUUFBZCxFQUF3QjtBQUM5Q0QsTUFBSUUsVUFBSixDQUFlRCxRQUFmO0FBQ0FELE1BQUlHLE9BQUosQ0FBWUYsUUFBWjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDRCxDQVZEOztRQWVFeEUsUyxHQUFBQSxTIiwiZmlsZSI6IlV0aWxpdGllcy5qcyIsInNvdXJjZXNDb250ZW50IjpbImxldCBVdGlsaXRpZXMgPSB7fVxuY29uc3QgZ2xvYmFsVHlwZSA9IHR5cGVvZiB3aW5kb3cgPT09IFwidW5kZWZpbmVkXCIgPyBnbG9iYWwgOiB3aW5kb3c7XG5cblV0aWxpdGllcy5nZXRWaWV3ZXIgPSBmdW5jdGlvbigpIHtcbiAgcmV0dXJuIG5ldyBQcm9taXNlKChyZXNvbHZlLCByZWplY3QpID0+IHtcbiAgICBpZiAoZ2xvYmFsVHlwZS52ID09PSBcInVuZGVmaW5lZFwiKSB7XG4gICAgICBsZXQgaW50ZXJ2YWwgPSBzZXRJbnRlcnZhbCgoKSA9PiB7XG4gICAgICAgIGlmIChnbG9iYWxUeXBlLnYgIT09IFwidW5kZWZpbmVkXCIpIHtcbiAgICAgICAgICByZXNvbHZlKGdsb2JhbFR5cGUudilcbiAgICAgICAgICBjbGVhckludGVydmFsKGludGVydmFsKVxuICAgICAgICB9XG4gICAgICB9LCA1MDApO1xuICAgIH0gZWxzZSByZXNvbHZlKGdsb2JhbFR5cGUudilcbiAgfSlcbn1cblxuVXRpbGl0aWVzLnByb21pc2VHZXRQcm9wZXJ0aWVzID0gZnVuY3Rpb24oX2RiSWQpIHtcbiAgcmV0dXJuIG5ldyBQcm9taXNlKHJlc29sdmUgPT4ge1xuICAgIFV0aWxpdGllcy5nZXRWaWV3ZXIoKS50aGVuKHZpZXdlciA9PiB7XG4gICAgICB2aWV3ZXIuZ2V0UHJvcGVydGllcyhfZGJJZCwgcmVzb2x2ZSk7XG4gICAgfSlcbiAgfSk7XG59XG5cblV0aWxpdGllcy5wcm9taXNlR2V0RXh0ZXJuYWxJZE1hcHBpbmcgPSBmdW5jdGlvbihfZXh0ZXJuYWxJZCkge1xuICByZXR1cm4gbmV3IFByb21pc2UocmVzb2x2ZSA9PiB7XG4gICAgVXRpbGl0aWVzLmdldFZpZXdlcigpLnRoZW4odmlld2VyID0+IHtcbiAgICAgIHZpZXdlci5tb2RlbC5nZXRFeHRlcm5hbElkTWFwcGluZyhyZXMgPT4ge1xuICAgICAgICByZXNvbHZlKHJlc1tfZXh0ZXJuYWxJZF0pXG4gICAgICB9KTtcbiAgICB9KVxuICB9KTtcbn1cblxuVXRpbGl0aWVzLnByb21pc2VMb2FkID0gZnVuY3Rpb24oX3B0cikge1xuICByZXR1cm4gbmV3IFByb21pc2UocmVzb2x2ZSA9PiB7XG4gICAgX3B0ci5sb2FkKHJlc29sdmUpO1xuICB9KTtcbn1cblxuXG5cblxuVXRpbGl0aWVzLmdldEV4dGVybmFsSWQgPSBhc3luYyBmdW5jdGlvbihfZGJJZCkge1xuICBsZXQgcHJvcGVydGllcyA9IGF3YWl0IFV0aWxpdGllcy5wcm9taXNlR2V0UHJvcGVydGllcyhfZGJJZCk7XG4gIHJldHVybiBwcm9wZXJ0aWVzLmV4dGVybmFsSWQ7XG59XG5cblV0aWxpdGllcy5nZXREYklkQnlFeHRlcm5hbElkID0gYXN5bmMgZnVuY3Rpb24oX2V4dGVybmFsSWQpIHtcbiAgbGV0IGRiaWQgPSBhd2FpdCBVdGlsaXRpZXMucHJvbWlzZUdldEV4dGVybmFsSWRNYXBwaW5nKF9leHRlcm5hbElkKTtcbiAgcmV0dXJuIGRiaWQ7XG59XG5cblV0aWxpdGllcy5hcnJheXNFcXVhbCA9IGZ1bmN0aW9uKGFycmF5QSwgYXJyYXlCKSB7XG4gIGlmIChhcnJheUEgPT09IGFycmF5QikgcmV0dXJuIHRydWU7XG4gIGlmIChhcnJheUEgPT0gbnVsbCB8fCBhcnJheUIgPT0gbnVsbCkgcmV0dXJuIGZhbHNlO1xuICBpZiAoYXJyYXlBLmxlbmd0aCAhPSBhcnJheUIubGVuZ3RoKSByZXR1cm4gZmFsc2U7XG4gIGFycmF5QS5zb3J0KCk7XG4gIGNvbnNvbGUubG9nKGFycmF5QSk7XG5cbiAgYXJyYXlCLnNvcnQoKTtcbiAgZm9yICh2YXIgaSA9IDA7IGkgPCBhcnJheUEubGVuZ3RoOyArK2kpIHtcbiAgICBpZiAoYXJyYXlBW2ldICE9PSBhcnJheUJbaV0pIHJldHVybiBmYWxzZTtcbiAgfVxuICByZXR1cm4gdHJ1ZTtcbn1cblxuLy8gVXRpbGl0aWVzLmNvbnRhaW5zTHN0QnlJZCA9IGZ1bmN0aW9uKF9saXN0LCBfbm9kZSkge1xuLy8gICBmb3IgKGxldCBpbmRleCA9IDA7IGluZGV4IDwgX2xpc3QubGVuZ3RoOyBpbmRleCsrKSB7XG4vLyAgICAgY29uc3QgZWxlbWVudCA9IF9saXN0W2luZGV4XTtcbi8vICAgICBpZiAoZWxlbWVudC5pZC5nZXQoKSA9PSBfbm9kZS5pZC5nZXQoKSlcbi8vICAgICAgIHJldHVybiB0cnVlXG4vLyAgIH1cbi8vICAgcmV0dXJuIGZhbHNlXG4vLyB9XG5cblV0aWxpdGllcy5jb250YWluc0xzdE1vZGVsID0gZnVuY3Rpb24oX2xpc3QsIF9tb2RlbCkge1xuICBmb3IgKGxldCBpbmRleCA9IDA7IGluZGV4IDwgX2xpc3QubGVuZ3RoOyBpbmRleCsrKSB7XG4gICAgY29uc3QgZWxlbWVudCA9IF9saXN0W2luZGV4XTtcbiAgICBpZiAoZWxlbWVudC5nZXQoKSA9PSBfbW9kZWwuZ2V0KCkpXG4gICAgICByZXR1cm4gdHJ1ZVxuICB9XG4gIHJldHVybiBmYWxzZVxufVxuXG5VdGlsaXRpZXMuY29udGFpbnNMc3QgPSBmdW5jdGlvbihfbGlzdCwgX2VsZW1lbnQpIHtcbiAgZm9yIChsZXQgaW5kZXggPSAwOyBpbmRleCA8IF9saXN0Lmxlbmd0aDsgaW5kZXgrKykge1xuICAgIGNvbnN0IGVsZW1lbnQgPSBfbGlzdFtpbmRleF07XG4gICAgaWYgKGVsZW1lbnQuZ2V0KCkgPT0gX2VsZW1lbnQpXG4gICAgICByZXR1cm4gdHJ1ZVxuICB9XG4gIHJldHVybiBmYWxzZVxufVxuXG5VdGlsaXRpZXMuaW5jbHVkZSA9IGZ1bmN0aW9uKGFyciwgb2JqKSB7XG4gIHJldHVybiAoYXJyLmluZGV4T2Yob2JqKSAhPSAtMSk7XG59XG5cblV0aWxpdGllcy5nZXRJbmRleCA9IGZ1bmN0aW9uKGFyciwgb2JqKSB7XG4gIHJldHVybiAoYXJyLmluZGV4T2Yob2JqKSk7XG59XG5cblV0aWxpdGllcy5nZXRJZHMgPSBmdW5jdGlvbihhcnJheSkge1xuICBsZXQgcmVzID0gW11cbiAgZm9yIChsZXQgaW5kZXggPSAwOyBpbmRleCA8IGFycmF5Lmxlbmd0aDsgaW5kZXgrKykge1xuICAgIHJlcy5wdXNoKGFycmF5W2luZGV4XS5pZC5nZXQoKSlcbiAgfVxuICByZXR1cm4gcmVzO1xufVxuLy8gVXRpbGl0aWVzLmFkZE5vdEV4aXN0aW5nID0gZnVuY3Rpb24oYXJyLCBvYmopIHtcbi8vICAgcmV0dXJuIChhcnIuaW5kZXhPZihvYmopKTtcbi8vIH1cblxuVXRpbGl0aWVzLmNvbmNhdCA9IGZ1bmN0aW9uKGxpc3RBLCBsaXN0Qikge1xuICBsZXQgcmVzID0gW11cbiAgZm9yIChsZXQgaW5kZXggPSAwOyBpbmRleCA8IGxpc3RBLmxlbmd0aDsgaW5kZXgrKykge1xuICAgIHJlcy5wdXNoKGxpc3RBW2luZGV4XSlcbiAgfVxuICBmb3IgKGxldCBpbmRleCA9IDA7IGluZGV4IDwgbGlzdEIubGVuZ3RoOyBpbmRleCsrKSB7XG4gICAgcmVzLnB1c2gobGlzdEJbaW5kZXhdKVxuICB9XG4gIHJldHVybiByZXM7XG59XG5cblV0aWxpdGllcy5hbGxCdXRNZUJ5SWQgPSBmdW5jdGlvbihfbGlzdCkge1xuICBsZXQgcmVzID0gW107XG4gIGZvciAobGV0IGluZGV4ID0gMDsgaW5kZXggPCBfbGlzdC5sZW5ndGg7IGluZGV4KyspIHtcbiAgICBjb25zdCBub2RlID0gX2xpc3RbaW5kZXhdO1xuICAgIGlmIChub2RlLmlkLmdldCgpICE9IHRoaXMuaWQuZ2V0KCkpIHtcbiAgICAgIHJlcy5wdXNoKG5vZGUpO1xuICAgIH1cbiAgICByZXR1cm4gcmVzO1xuICB9XG59XG5cblV0aWxpdGllcy5ndWlkID0gZnVuY3Rpb24oX2NvbnN0cnVjdG9yKSB7XG4gIHJldHVybiAoXG4gICAgX2NvbnN0cnVjdG9yICtcbiAgICBcIi1cIiArXG4gICAgdGhpcy5zNCgpICtcbiAgICB0aGlzLnM0KCkgK1xuICAgIFwiLVwiICtcbiAgICB0aGlzLnM0KCkgK1xuICAgIFwiLVwiICtcbiAgICB0aGlzLnM0KCkgK1xuICAgIFwiLVwiICtcbiAgICB0aGlzLnM0KCkgK1xuICAgIFwiLVwiICtcbiAgICB0aGlzLnM0KCkgK1xuICAgIHRoaXMuczQoKSArXG4gICAgdGhpcy5zNCgpICtcbiAgICBcIi1cIiArXG4gICAgRGF0ZS5ub3coKS50b1N0cmluZygxNilcbiAgKTtcbn1cblxuVXRpbGl0aWVzLnM0ID0gZnVuY3Rpb24oKSB7XG4gIHJldHVybiBNYXRoLmZsb29yKCgxICsgTWF0aC5yYW5kb20oKSkgKiAweDEwMDAwKVxuICAgIC50b1N0cmluZygxNilcbiAgICAuc3Vic3RyaW5nKDEpO1xufVxuXG5VdGlsaXRpZXMucHV0T25Ub3BMc3QgPSBmdW5jdGlvbihsc3QsIGVsZW1lbnRCKSB7XG4gIGxzdC5yZW1vdmVfcmVmKGVsZW1lbnRCKTtcbiAgbHN0LnVuc2hpZnQoZWxlbWVudEIpO1xuICAvLyBmb3IgKGxldCBpbmRleCA9IDA7IGluZGV4IDwgbHN0Lmxlbmd0aDsgaW5kZXgrKykge1xuICAvLyAgIGNvbnN0IGVsZW1lbnQgPSBsc3RbaW5kZXhdO1xuICAvLyAgIGlmIChlbGVtZW50LmlkLmdldCgpID09PSBlbGVtZW50Qi5pZC5nZXQoKSkge1xuICAvLyAgICAgbHN0LnJlbW92ZShpbmRleCk7XG4gIC8vICAgfVxuXG4gIC8vIH1cbn1cblxuXG5cbmV4cG9ydCB7XG4gIFV0aWxpdGllc1xufSJdfQ==