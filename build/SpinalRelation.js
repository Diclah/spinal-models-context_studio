"use strict";

Object.defineProperty(exports, "__esModule", {
  value: true
});

var _Utilities = require("./Utilities");

const spinalCore = require("spinal-core-connectorjs");
const globalType = typeof window === "undefined" ? global : window;
let getViewer = function () {
  return globalType.v;
};

class SpinalRelation extends globalType.Model {
  constructor(_type, _vertexList1, _vertexList2, _isDirected) {
    super();
    if (FileSystem._sig_server) {
      this.add_attr({
        id: this.guid(),
        type: _type,
        vertexList1: _vertexList1,
        vertexList2: _vertexList2,
        isDirected: _isDirected || false
      });
    }
  }

  guid() {
    return this.constructor.name + "-" + this.s4() + this.s4() + "-" + this.s4() + "-" + this.s4() + "-" + this.s4() + "-" + this.s4() + this.s4() + this.s4() + "-" + Date.now().toString(16);
  }

  s4() {
    return Math.floor((1 + Math.random()) * 0x10000).toString(16).substring(1);
  }

  getVertexList1Ids() {
    let t = [];
    for (let index = 0; index < this.vertexList1.length; index++) {
      const element = this.vertexList1[index];
      t.push(element.id.get());
    }
    return t;
  }

  getVertexList1List2Ids() {
    let t = [];
    for (let index = 0; index < this.vertexList1.length; index++) {
      const element = this.vertexList1[index];
      t.push(element.id.get());
    }
    for (let index = 0; index < this.vertexList2.length; index++) {
      const element = this.vertexList2[index];
      t.push(element.id.get());
    }
    return t;
  }

  addNotExistingVertextoVertexList1(_vertex) {
    if (!_Utilities.Utilities.contains(this.vertexList1, _vertex)) this.vertexList1.push(_vertex);
  }

  addNotExistingVerticestoVertexList1(_vertices) {
    for (let index = 0; index < _vertices.length; index++) {
      const element = _vertices[index];
      this.addNotExistingVertextoVertexList1(element);
    }
  }

  addNotExistingVertextoVertexList2(_vertex) {
    if (!_Utilities.Utilities.contains(this.vertexList2, _vertex)) this.vertexList2.push(_vertex);
  }

  addNotExistingVerticestoVertexList2(_vertices) {
    console.log(_vertices);

    for (let index = 0; index < _vertices.length; index++) {
      const element = _vertices[index];
      this.addNotExistingVertextoVertexList2(element);
    }
  }

  addNotExistingVertextoRelation(_relation) {
    other = [];
    for (let index = 0; index < _relation.vertexList1.length; index++) {
      const element = _relation.vertexList1[index];
      other.push(element);
    }
    for (let index = 0; index < _relation.vertexList2.length; index++) {
      const element = _relation.vertexList2[index];
      other.push(element);
    }

    me = [];
    for (let index = 0; index < this.vertexList1.length; index++) {
      const element = this.vertexList1[index];
      me.push(element);
    }
    for (let index = 0; index < this.vertexList2.length; index++) {
      const element = this.vertexList2[index];
      me.push(element);
    }
    for (let index = 0; index < other.length; index++) {
      const vertex = other[index];
      if (!_Utilities.Utilities.contains(me, vertex)) this.vertexList2.push(vertex);
    }
  }
}

exports.default = SpinalRelation;
spinalCore.register_models([SpinalRelation]);
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uL3NyYy9TcGluYWxSZWxhdGlvbi5qcyJdLCJuYW1lcyI6WyJzcGluYWxDb3JlIiwicmVxdWlyZSIsImdsb2JhbFR5cGUiLCJ3aW5kb3ciLCJnbG9iYWwiLCJnZXRWaWV3ZXIiLCJ2IiwiU3BpbmFsUmVsYXRpb24iLCJNb2RlbCIsImNvbnN0cnVjdG9yIiwiX3R5cGUiLCJfdmVydGV4TGlzdDEiLCJfdmVydGV4TGlzdDIiLCJfaXNEaXJlY3RlZCIsIkZpbGVTeXN0ZW0iLCJfc2lnX3NlcnZlciIsImFkZF9hdHRyIiwiaWQiLCJndWlkIiwidHlwZSIsInZlcnRleExpc3QxIiwidmVydGV4TGlzdDIiLCJpc0RpcmVjdGVkIiwibmFtZSIsInM0IiwiRGF0ZSIsIm5vdyIsInRvU3RyaW5nIiwiTWF0aCIsImZsb29yIiwicmFuZG9tIiwic3Vic3RyaW5nIiwiZ2V0VmVydGV4TGlzdDFJZHMiLCJ0IiwiaW5kZXgiLCJsZW5ndGgiLCJlbGVtZW50IiwicHVzaCIsImdldCIsImdldFZlcnRleExpc3QxTGlzdDJJZHMiLCJhZGROb3RFeGlzdGluZ1ZlcnRleHRvVmVydGV4TGlzdDEiLCJfdmVydGV4IiwiVXRpbGl0aWVzIiwiY29udGFpbnMiLCJhZGROb3RFeGlzdGluZ1ZlcnRpY2VzdG9WZXJ0ZXhMaXN0MSIsIl92ZXJ0aWNlcyIsImFkZE5vdEV4aXN0aW5nVmVydGV4dG9WZXJ0ZXhMaXN0MiIsImFkZE5vdEV4aXN0aW5nVmVydGljZXN0b1ZlcnRleExpc3QyIiwiY29uc29sZSIsImxvZyIsImFkZE5vdEV4aXN0aW5nVmVydGV4dG9SZWxhdGlvbiIsIl9yZWxhdGlvbiIsIm90aGVyIiwibWUiLCJ2ZXJ0ZXgiLCJyZWdpc3Rlcl9tb2RlbHMiXSwibWFwcGluZ3MiOiI7Ozs7OztBQU1BOztBQU5BLE1BQU1BLGFBQWFDLFFBQVEseUJBQVIsQ0FBbkI7QUFDQSxNQUFNQyxhQUFhLE9BQU9DLE1BQVAsS0FBa0IsV0FBbEIsR0FBZ0NDLE1BQWhDLEdBQXlDRCxNQUE1RDtB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LElBQUlGLFFBQVEsQ0FBakIsRUFBb0JBLFFBQVEsS0FBS2IsV0FBTCxDQUFpQmMsTUFBN0MsRUFBcURELE9BQXJELEVBQThEO0FBQzVELFlBQU1FLFVBQVUsS0FBS2YsV0FBTCxDQUFpQmEsS0FBakIsQ0FBaEI7QUFDQW1CLFNBQUdoQixJQUFILENBQVFELE9BQVI7QUFDRDtBQUNELFNBQUssSUFBSUYsUUFBUSxDQUFqQixFQUFvQkEsUUFBUWtCLE1BQU1qQixNQUFsQyxFQUEwQ0QsT0FBMUMsRUFBbUQ7QUFDakQsWUFBTW9CLFNBQVNGLE1BQU1sQixLQUFOLENBQWY7QUFDQSxVQUFJLENBQUNRLHFCQUFVQyxRQUFWLENBQW1CVSxFQUFuQixFQUF1QkMsTUFBdkIsQ0FBTCxFQUNFLEtBQUtqQyxXQUFMLENBQWlCZ0IsSUFBakIsQ0FBc0JpQixNQUF0QjtBQUNIO0FBQ0Y7QUFsSDBEOztrQkFBeEMvQyxjO0FBcUhyQlAsV0FBV3VELGVBQVgsQ0FBMkIsQ0FBQ2hELGNBQUQsQ0FBM0IiLCJmaWxlIjoiU3BpbmFsUmVsYXRpb24uanMiLCJzb3VyY2VzQ29udGVudCI6WyJjb25zdCBzcGluYWxDb3JlID0gcmVxdWlyZShcInNwaW5hbC1jb3JlLWNvbm5lY3RvcmpzXCIpO1xuY29uc3QgZ2xvYmFsVHlwZSA9IHR5cGVvZiB3aW5kb3cgPT09IFwidW5kZWZpbmVkXCIgPyBnbG9iYWwgOiB3aW5kb3c7XG5sZXQgZ2V0Vmlld2VyID0gZnVuY3Rpb24oKSB7XG4gIHJldHVybiBnbG9iYWxUeXBlLnY7XG59O1xuXG5pbXBvcnQge1xuICBVdGlsaXRpZXNcbn0gZnJvbSBcIi4vVXRpbGl0aWVzXCJcblxuZXhwb3J0IGRlZmF1bHQgY2xhc3MgU3BpbmFsUmVsYXRpb24gZXh0ZW5kcyBnbG9iYWxUeXBlLk1vZGVsIHtcbiAgY29uc3RydWN0b3IoX3R5cGUsIF92ZXJ0ZXhMaXN0MSwgX3ZlcnRleExpc3QyLCBfaXNEaXJlY3RlZCkge1xuICAgIHN1cGVyKCk7XG4gICAgaWYgKEZpbGVTeXN0ZW0uX3NpZ19zZXJ2ZXIpIHtcbiAgICAgIHRoaXMuYWRkX2F0dHIoe1xuICAgICAgICBpZDogdGhpcy5ndWlkKCksXG4gICAgICAgIHR5cGU6IF90eXBlLFxuICAgICAgICB2ZXJ0ZXhMaXN0MTogX3ZlcnRleExpc3QxLFxuICAgICAgICB2ZXJ0ZXhMaXN0MjogX3ZlcnRleExpc3QyLFxuICAgICAgICBpc0RpcmVjdGVkOiBfaXNEaXJlY3RlZCB8fCBmYWxzZVxuICAgICAgfSk7XG4gICAgfVxuICB9XG5cbiAgZ3VpZCgpIHtcbiAgICByZXR1cm4gKFxuICAgICAgdGhpcy5jb25zdHJ1Y3Rvci5uYW1lICtcbiAgICAgIFwiLVwiICtcbiAgICAgIHRoaXMuczQoKSArXG4gICAgICB0aGlzLnM0KCkgK1xuICAgICAgXCItXCIgK1xuICAgICAgdGhpcy5zNCgpICtcbiAgICAgIFwiLVwiICtcbiAgICAgIHRoaXMuczQoKSArXG4gICAgICBcIi1cIiArXG4gICAgICB0aGlzLnM0KCkgK1xuICAgICAgXCItXCIgK1xuICAgICAgdGhpcy5zNCgpICtcbiAgICAgIHRoaXMuczQoKSArXG4gICAgICB0aGlzLnM0KCkgK1xuICAgICAgXCItXCIgK1xuICAgICAgRGF0ZS5ub3coKS50b1N0cmluZygxNilcbiAgICApO1xuICB9XG5cbiAgczQoKSB7XG4gICAgcmV0dXJuIE1hdGguZmxvb3IoKDEgKyBNYXRoLnJhbmRvbSgpKSAqIDB4MTAwMDApXG4gICAgICAudG9TdHJpbmcoMTYpXG4gICAgICAuc3Vic3RyaW5nKDEpO1xuICB9XG5cbiAgZ2V0VmVydGV4TGlzdDFJZHMoKSB7XG4gICAgbGV0IHQgPSBbXVxuICAgIGZvciAobGV0IGluZGV4ID0gMDsgaW5kZXggPCB0aGlzLnZlcnRleExpc3QxLmxlbmd0aDsgaW5kZXgrKykge1xuICAgICAgY29uc3QgZWxlbWVudCA9IHRoaXMudmVydGV4TGlzdDFbaW5kZXhdO1xuICAgICAgdC5wdXNoKGVsZW1lbnQuaWQuZ2V0KCkpXG4gICAgfVxuICAgIHJldHVybiB0XG4gIH1cblxuICBnZXRWZXJ0ZXhMaXN0MUxpc3QySWRzKCkge1xuICAgIGxldCB0ID0gW11cbiAgICBmb3IgKGxldCBpbmRleCA9IDA7IGluZGV4IDwgdGhpcy52ZXJ0ZXhMaXN0MS5sZW5ndGg7IGluZGV4KyspIHtcbiAgICAgIGNvbnN0IGVsZW1lbnQgPSB0aGlzLnZlcnRleExpc3QxW2luZGV4XTtcbiAgICAgIHQucHVzaChlbGVtZW50LmlkLmdldCgpKVxuICAgIH1cbiAgICBmb3IgKGxldCBpbmRleCA9IDA7IGluZGV4IDwgdGhpcy52ZXJ0ZXhMaXN0Mi5sZW5ndGg7IGluZGV4KyspIHtcbiAgICAgIGNvbnN0IGVsZW1lbnQgPSB0aGlzLnZlcnRleExpc3QyW2luZGV4XTtcbiAgICAgIHQucHVzaChlbGVtZW50LmlkLmdldCgpKVxuICAgIH1cbiAgICByZXR1cm4gdFxuICB9XG5cbiAgYWRkTm90RXhpc3RpbmdWZXJ0ZXh0b1ZlcnRleExpc3QxKF92ZXJ0ZXgpIHtcbiAgICBpZiAoIVV0aWxpdGllcy5jb250YWlucyh0aGlzLnZlcnRleExpc3QxLCBfdmVydGV4KSlcbiAgICAgIHRoaXMudmVydGV4TGlzdDEucHVzaChfdmVydGV4KVxuICB9XG5cbiAgYWRkTm90RXhpc3RpbmdWZXJ0aWNlc3RvVmVydGV4TGlzdDEoX3ZlcnRpY2VzKSB7XG4gICAgZm9yIChsZXQgaW5kZXggPSAwOyBpbmRleCA8IF92ZXJ0aWNlcy5sZW5ndGg7IGluZGV4KyspIHtcbiAgICAgIGNvbnN0IGVsZW1lbnQgPSBfdmVydGljZXNbaW5kZXhdO1xuICAgICAgdGhpcy5hZGROb3RFeGlzdGluZ1ZlcnRleHRvVmVydGV4TGlzdDEoZWxlbWVudClcbiAgICB9XG4gIH1cblxuICBhZGROb3RFeGlzdGluZ1ZlcnRleHRvVmVydGV4TGlzdDIoX3ZlcnRleCkge1xuICAgIGlmICghVXRpbGl0aWVzLmNvbnRhaW5zKHRoaXMudmVydGV4TGlzdDIsIF92ZXJ0ZXgpKVxuICAgICAgdGhpcy52ZXJ0ZXhMaXN0Mi5wdXNoKF92ZXJ0ZXgpXG4gIH1cblxuICBhZGROb3RFeGlzdGluZ1ZlcnRpY2VzdG9WZXJ0ZXhMaXN0MihfdmVydGljZXMpIHtcbiAgICBjb25zb2xlLmxvZyhfdmVydGljZXMpO1xuXG4gICAgZm9yIChsZXQgaW5kZXggPSAwOyBpbmRleCA8IF92ZXJ0aWNlcy5sZW5ndGg7IGluZGV4KyspIHtcbiAgICAgIGNvbnN0IGVsZW1lbnQgPSBfdmVydGljZXNbaW5kZXhdO1xuICAgICAgdGhpcy5hZGROb3RFeGlzdGluZ1ZlcnRleHRvVmVydGV4TGlzdDIoZWxlbWVudClcbiAgICB9XG4gIH1cblxuICBhZGROb3RFeGlzdGluZ1ZlcnRleHRvUmVsYXRpb24oX3JlbGF0aW9uKSB7XG4gICAgb3RoZXIgPSBbXVxuICAgIGZvciAobGV0IGluZGV4ID0gMDsgaW5kZXggPCBfcmVsYXRpb24udmVydGV4TGlzdDEubGVuZ3RoOyBpbmRleCsrKSB7XG4gICAgICBjb25zdCBlbGVtZW50ID0gX3JlbGF0aW9uLnZlcnRleExpc3QxW2luZGV4XTtcbiAgICAgIG90aGVyLnB1c2goZWxlbWVudClcbiAgICB9XG4gICAgZm9yIChsZXQgaW5kZXggPSAwOyBpbmRleCA8IF9yZWxhdGlvbi52ZXJ0ZXhMaXN0Mi5sZW5ndGg7IGluZGV4KyspIHtcbiAgICAgIGNvbnN0IGVsZW1lbnQgPSBfcmVsYXRpb24udmVydGV4TGlzdDJbaW5kZXhdO1xuICAgICAgb3RoZXIucHVzaChlbGVtZW50KVxuICAgIH1cblxuICAgIG1lID0gW11cbiAgICBmb3IgKGxldCBpbmRleCA9IDA7IGluZGV4IDwgdGhpcy52ZXJ0ZXhMaXN0MS5sZW5ndGg7IGluZGV4KyspIHtcbiAgICAgIGNvbnN0IGVsZW1lbnQgPSB0aGlzLnZlcnRleExpc3QxW2luZGV4XTtcbiAgICAgIG1lLnB1c2goZWxlbWVudClcbiAgICB9XG4gICAgZm9yIChsZXQgaW5kZXggPSAwOyBpbmRleCA8IHRoaXMudmVydGV4TGlzdDIubGVuZ3RoOyBpbmRleCsrKSB7XG4gICAgICBjb25zdCBlbGVtZW50ID0gdGhpcy52ZXJ0ZXhMaXN0MltpbmRleF07XG4gICAgICBtZS5wdXNoKGVsZW1lbnQpXG4gICAgfVxuICAgIGZvciAobGV0IGluZGV4ID0gMDsgaW5kZXggPCBvdGhlci5sZW5ndGg7IGluZGV4KyspIHtcbiAgICAgIGNvbnN0IHZlcnRleCA9IG90aGVyW2luZGV4XVxuICAgICAgaWYgKCFVdGlsaXRpZXMuY29udGFpbnMobWUsIHZlcnRleCkpXG4gICAgICAgIHRoaXMudmVydGV4TGlzdDIucHVzaCh2ZXJ0ZXgpXG4gICAgfVxuICB9XG59XG5cbnNwaW5hbENvcmUucmVnaXN0ZXJfbW9kZWxzKFtTcGluYWxSZWxhdGlvbl0pOyJdfQ==