"use strict";

Object.defineProperty(exports, "__esModule", {
  value: true
});
const spinalCore = require("spinal-core-connectorjs");
const globalType = typeof window === "undefined" ? global : window;

class Graph extends globalType.Model {
  constructor(_name, _startingVertex, name = "Graph") {
    super();
    if (FileSystem._sig_server) {
      this.add_attr({
        name: _name || "",
        startingVertex: _startingVertex || new Ptr(0),
        vertexList: new Ptr(new Lst()),
        vertexListByElementType: new Model(),
        relationList: new Ptr(new Lst()),
        relationListByType: new Model()
      });
    }
  }

  guid() {
    return this.constructor.name + "-" + this.s4() + this.s4() + "-" + this.s4() + "-" + this.s4() + "-" + this.s4() + "-" + this.s4() + this.s4() + this.s4() + "-" + Date.now().toString(16);
  }

  s4() {
    return Math.floor((1 + Math.random()) * 0x10000).toString(16).substring(1);
  }

  setName(_name) {
    this.name.set(_name);
  }

  addStartingVertex(_startingVertex) {
    this.mod_attr("startingVertex", new Ptr(_startingVertex));
  }

  addVertex(_vertex) {
    _vertex.graph.set(this);
    this.vertexList.load(vertexList => {
      vertexList.push(_vertex);
    });
    if (this.vertexListByElementType[_vertex.element.type.get()]) {
      this.vertexListByElementType[_vertex.element.type.get()].load(vertexListOfType => {
        vertexListOfType.push(_vertex);
      });
    } else {
      let vertexListOfType = new Lst();
      vertexListOfType.push(_vertex);
      this.vertexListByElementType.add_attr({
        [_vertex.element.type.get()]: new Ptr(vertexListOfType)
      });
    }
  }

  addVertices(_vertices) {
    for (let index = 0; index < _vertices.length; index++) {
      this.addVertex(_vertices[index]);
    }
  }

  addRelation(_relation) {
    this.relationList.load(relationList => {
      relationList.push(_relation);
    });
    if (this.relationListByType[_relation.type.get()]) {
      this.relationListByType[_relation.type.get()].load(relationListOfType => {
        relationListOfType.push(_relation);
      });
    } else {
      let relationListOfType = new Lst();
      relationListOfType.push(_relation);
      this.relationListByType.add_attr({
        [_relation.type.get()]: new Ptr(relationListOfType)
      });
    }
  }

  addRelations(_relations) {
    for (let index = 0; index < _relations.length; index++) {
      this.addRelation(_relations[index]);
    }
  }

  static _contains(_list, _vertex) {
    for (let index = 0; index < _list.length; index++) {
      const element = _list[index];
      if (element.id.get() == _vertex.id.get()) return true;
    }
    return false;
  }

  _addNotExistingVerticesFromList(_list) {
    this.vertexList.load(vertexList => {
      for (let i = 0; i < _list.length; i++) {
        let vertex = _list[i];
        if (!Graph._contains(vertexList, vertex)) this.addVertex(vertex);
      }
    });
  }

  _addNotExistingVerticesFromRelation(_relation) {
    this._addNotExistingVerticesFromList(_relation.vertexList1);
    this._addNotExistingVerticesFromList(_relation.vertexList2);
  }

}

exports.default = Graph;
spinalCore.register_models([Graph]);
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uL3NyYy9HcmFwaC5qcyJdLCJuYW1lcyI6WyJzcGluYWxDb3JlIiwicmVxdWlyZSIsImdsb2JhbFR5cGUiLCJ3aW5kb3ciLCJnbG9iYWwiLCJHcmFwaCIsIk1vZGVsIiwiY29uc3RydWN0b3IiLCJfbmFtZSIsIl9zdGFydGluZ1ZlcnRleCIsIm5hbWUiLCJGaWxlU3lzdGVtIiwiX3NpZ19zZXJ2ZXIiLCJhZGRfYXR0ciIsInN0YXJ0aW5nVmVydGV4IiwiUHRyIiwidmVydGV4TGlzdCIsIkxzdCIsInZlcnRleExpc3RCeUVsZW1lbnRUeXBlIiwicmVsYXRpb25MaXN0IiwicmVsYXRpb25MaXN0QnlUeXBlIiwiZ3VpZCIsInM0IiwiRGF0ZSIsIm5vdyIsInRvU3RyaW5nIiwiTWF0aCIsImZsb29yIiwicmFuZG9tIiwic3Vic3RyaW5nIiwic2V0TmFtZSIsInNldCIsImFkZFN0YXJ0aW5nVmVydGV4IiwibW9kX2F0dHIiLCJhZGRWZXJ0ZXgiLCJfdmVydGV4IiwiZ3JhcGgiLCJsb2FkIiwicHVzaCIsImVsZW1lbnQiLCJ0eXBlIiwiZ2V0IiwidmVydGV4TGlzdE9mVHlwZSIsImFkZFZlcnRpY2VzIiwiX3ZlcnRpY2VzIiwiaW5kZXgiLCJsZW5ndGgiLCJhZGRSZWxhdGlvbiIsIl9yZWxhdGlvbiIsInJlbGF0aW9uTGlzdE9mVHlwZSIsImFkZFJlbGF0aW9ucyIsIl9yZWxhdGlvbnMiLCJfY29udGFpbnMiLCJfbGlzdCIsImlkIiwiX2FkZE5vdEV4aXN0aW5nVmVydGljZXNGcm9tTGlzdCIsImkiLCJ2ZXJ0ZXgiLCJfYWRkTm90RXhpc3RpbmdWZXJ0aWNlc0Zyb21SZWxhdGlvbiIsInZlcnRleExpc3QxIiwidmVydGV4TGlzdDIiLCJyZWdpc3Rlcl9tb2RlbHMiXSwibWFwcGluZ3MiOiI7Ozs7O0FBQUEsTUFBTUEsYUFBYUMsUUFBUSx5QkFBUixDQUFuQjtBQUNBLE1BQU1DLGFBQWEsT0FBT0MsTUFBUCxLQUFrQixXQUFsQixHQUFnQ0MsTUFBaEMsR0FBeUNE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V0FBTyxLQUFQO0FBQ0Q7O0FBRURjLGtDQUFnQ0YsS0FBaEMsRUFBdUM7QUFDckMsU0FBS3JDLFVBQUwsQ0FBZ0JxQixJQUFoQixDQUFxQnJCLGNBQWM7QUFDakMsV0FBSyxJQUFJd0MsSUFBSSxDQUFiLEVBQWdCQSxJQUFJSCxNQUFNUCxNQUExQixFQUFrQ1UsR0FBbEMsRUFBdUM7QUFDckMsWUFBSUMsU0FBU0osTUFBTUcsQ0FBTixDQUFiO0FBQ0EsWUFBSSxDQUFDbkQsTUFBTStDLFNBQU4sQ0FBZ0JwQyxVQUFoQixFQUE0QnlDLE1BQTVCLENBQUwsRUFDRSxLQUFLdkIsU0FBTCxDQUFldUIsTUFBZjtBQUNIO0FBQ0YsS0FORDtBQU9EOztBQUVEQyxzQ0FBb0NWLFNBQXBDLEVBQStDO0FBQzdDLFNBQUtPLCtCQUFMLENBQXFDUCxVQUFVVyxXQUEvQztBQUNBLFNBQUtKLCtCQUFMLENBQXFDUCxVQUFVWSxXQUEvQztBQUNEOztBQTdIaUQ7O2tCQUEvQnZELEs7QUFpSXJCTCxXQUFXNkQsZUFBWCxDQUEyQixDQUFDeEQsS0FBRCxDQUEzQiIsImZpbGUiOiJHcmFwaC5qcyIsInNvdXJjZXNDb250ZW50IjpbImNvbnN0IHNwaW5hbENvcmUgPSByZXF1aXJlKFwic3BpbmFsLWNvcmUtY29ubmVjdG9yanNcIik7XG5jb25zdCBnbG9iYWxUeXBlID0gdHlwZW9mIHdpbmRvdyA9PT0gXCJ1bmRlZmluZWRcIiA/IGdsb2JhbCA6IHdpbmRvdztcblxuZXhwb3J0IGRlZmF1bHQgY2xhc3MgR3JhcGggZXh0ZW5kcyBnbG9iYWxUeXBlLk1vZGVsIHtcbiAgY29uc3RydWN0b3IoX25hbWUsIF9zdGFydGluZ1ZlcnRleCwgbmFtZSA9IFwiR3JhcGhcIikge1xuICAgIHN1cGVyKCk7XG4gICAgaWYgKEZpbGVTeXN0ZW0uX3NpZ19zZXJ2ZXIpIHtcbiAgICAgIHRoaXMuYWRkX2F0dHIoe1xuICAgICAgICBuYW1lOiBfbmFtZSB8fCBcIlwiLFxuICAgICAgICBzdGFydGluZ1ZlcnRleDogX3N0YXJ0aW5nVmVydGV4IHx8IG5ldyBQdHIoMCksXG4gICAgICAgIHZlcnRleExpc3Q6IG5ldyBQdHIobmV3IExzdCgpKSxcbiAgICAgICAgdmVydGV4TGlzdEJ5RWxlbWVudFR5cGU6IG5ldyBNb2RlbCgpLFxuICAgICAgICByZWxhdGlvbkxpc3Q6IG5ldyBQdHIobmV3IExzdCgpKSxcbiAgICAgICAgcmVsYXRpb25MaXN0QnlUeXBlOiBuZXcgTW9kZWwoKVxuICAgICAgfSk7XG4gICAgfVxuICB9XG5cbiAgZ3VpZCgpIHtcbiAgICByZXR1cm4gKFxuICAgICAgdGhpcy5jb25zdHJ1Y3Rvci5uYW1lICtcbiAgICAgIFwiLVwiICtcbiAgICAgIHRoaXMuczQoKSArXG4gICAgICB0aGlzLnM0KCkgK1xuICAgICAgXCItXCIgK1xuICAgICAgdGhpcy5zNCgpICtcbiAgICAgIFwiLVwiICtcbiAgICAgIHRoaXMuczQoKSArXG4gICAgICBcIi1cIiArXG4gICAgICB0aGlzLnM0KCkgK1xuICAgICAgXCItXCIgK1xuICAgICAgdGhpcy5zNCgpICtcbiAgICAgIHRoaXMuczQoKSArXG4gICAgICB0aGlzLnM0KCkgK1xuICAgICAgXCItXCIgK1xuICAgICAgRGF0ZS5ub3coKS50b1N0cmluZygxNilcbiAgICApO1xuICB9XG5cbiAgczQoKSB7XG4gICAgcmV0dXJuIE1hdGguZmxvb3IoKDEgKyBNYXRoLnJhbmRvbSgpKSAqIDB4MTAwMDApXG4gICAgICAudG9TdHJpbmcoMTYpXG4gICAgICAuc3Vic3RyaW5nKDEpO1xuICB9XG5cbiAgc2V0TmFtZShfbmFtZSkge1xuICAgIHRoaXMubmFtZS5zZXQoX25hbWUpXG4gIH1cblxuICBhZGRTdGFydGluZ1ZlcnRleChfc3RhcnRpbmdWZXJ0ZXgpIHtcbiAgICB0aGlzLm1vZF9hdHRyKFwic3RhcnRpbmdWZXJ0ZXhcIiwgbmV3IFB0cihfc3RhcnRpbmdWZXJ0ZXgpKVxuICB9XG5cbiAgYWRkVmVydGV4KF92ZXJ0ZXgpIHtcbiAgICBfdmVydGV4LmdyYXBoLnNldCh0aGlzKTtcbiAgICB0aGlzLnZlcnRleExpc3QubG9hZCh2ZXJ0ZXhMaXN0ID0+IHtcbiAgICAgIHZlcnRleExpc3QucHVzaChfdmVydGV4KVxuICAgIH0pXG4gICAgaWYgKHRoaXMudmVydGV4TGlzdEJ5RWxlbWVudFR5cGVbX3ZlcnRleC5lbGVtZW50LnR5cGUuZ2V0KCldKSB7XG4gICAgICB0aGlzLnZlcnRleExpc3RCeUVsZW1lbnRUeXBlW192ZXJ0ZXguZWxlbWVudC50eXBlLmdldCgpXS5sb2FkKFxuICAgICAgICB2ZXJ0ZXhMaXN0T2ZUeXBlID0+IHtcbiAgICAgICAgICB2ZXJ0ZXhMaXN0T2ZUeXBlLnB1c2goX3ZlcnRleClcbiAgICAgICAgfSlcbiAgICB9IGVsc2Uge1xuICAgICAgbGV0IHZlcnRleExpc3RPZlR5cGUgPSBuZXcgTHN0KClcbiAgICAgIHZlcnRleExpc3RPZlR5cGUucHVzaChfdmVydGV4KTtcbiAgICAgIHRoaXMudmVydGV4TGlzdEJ5RWxlbWVudFR5cGUuYWRkX2F0dHIoe1xuICAgICAgICBbX3ZlcnRleC5lbGVtZW50LnR5cGUuZ2V0KCldOiBuZXcgUHRyKFxuICAgICAgICAgIHZlcnRleExpc3RPZlR5cGUpXG4gICAgICB9KVxuICAgIH1cbiAgfVxuXG4gIGFkZFZlcnRpY2VzKF92ZXJ0aWNlcykge1xuICAgIGZvciAobGV0IGluZGV4ID0gMDsgaW5kZXggPCBfdmVydGljZXMubGVuZ3RoOyBpbmRleCsrKSB7XG4gICAgICB0aGlzLmFkZFZlcnRleChfdmVydGljZXNbaW5kZXhdKVxuICAgIH1cbiAgfVxuXG5cblxuICBhZGRSZWxhdGlvbihfcmVsYXRpb24pIHtcbiAgICB0aGlzLnJlbGF0aW9uTGlzdC5sb2FkKHJlbGF0aW9uTGlzdCA9PiB7XG4gICAgICByZWxhdGlvbkxpc3QucHVzaChfcmVsYXRpb24pXG4gICAgfSlcbiAgICBpZiAodGhpcy5yZWxhdGlvbkxpc3RCeVR5cGVbX3JlbGF0aW9uLnR5cGUuZ2V0KCldKSB7XG4gICAgICB0aGlzLnJlbGF0aW9uTGlzdEJ5VHlwZVtfcmVsYXRpb24udHlwZS5nZXQoKV0ubG9hZChcbiAgICAgICAgcmVsYXRpb25MaXN0T2ZUeXBlID0+IHtcbiAgICAgICAgICByZWxhdGlvbkxpc3RPZlR5cGUucHVzaChfcmVsYXRpb24pXG4gICAgICAgIH0pXG4gICAgfSBlbHNlIHtcbiAgICAgIGxldCByZWxhdGlvbkxpc3RPZlR5cGUgPSBuZXcgTHN0KClcbiAgICAgIHJlbGF0aW9uTGlzdE9mVHlwZS5wdXNoKF9yZWxhdGlvbik7XG4gICAgICB0aGlzLnJlbGF0aW9uTGlzdEJ5VHlwZS5hZGRfYXR0cih7XG4gICAgICAgIFtfcmVsYXRpb24udHlwZS5nZXQoKV06IG5ldyBQdHIoXG4gICAgICAgICAgcmVsYXRpb25MaXN0T2ZUeXBlKVxuICAgICAgfSlcbiAgICB9XG4gIH1cblxuICBhZGRSZWxhdGlvbnMoX3JlbGF0aW9ucykge1xuICAgIGZvciAobGV0IGluZGV4ID0gMDsgaW5kZXggPCBfcmVsYXRpb25zLmxlbmd0aDsgaW5kZXgrKykge1xuICAgICAgdGhpcy5hZGRSZWxhdGlvbihfcmVsYXRpb25zW2luZGV4XSlcbiAgICB9XG4gIH1cblxuICBzdGF0aWMgX2NvbnRhaW5zKF9saXN0LCBfdmVydGV4KSB7XG4gICAgZm9yIChsZXQgaW5kZXggPSAwOyBpbmRleCA8IF9saXN0Lmxlbmd0aDsgaW5kZXgrKykge1xuICAgICAgY29uc3QgZWxlbWVudCA9IF9saXN0W2luZGV4XTtcbiAgICAgIGlmIChlbGVtZW50LmlkLmdldCgpID09IF92ZXJ0ZXguaWQuZ2V0KCkpXG4gICAgICAgIHJldHVybiB0cnVlXG4gICAgfVxuICAgIHJldHVybiBmYWxzZVxuICB9XG5cbiAgX2FkZE5vdEV4aXN0aW5nVmVydGljZXNGcm9tTGlzdChfbGlzdCkge1xuICAgIHRoaXMudmVydGV4TGlzdC5sb2FkKHZlcnRleExpc3QgPT4ge1xuICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCBfbGlzdC5sZW5ndGg7IGkrKykge1xuICAgICAgICBsZXQgdmVydGV4ID0gX2xpc3RbaV07XG4gICAgICAgIGlmICghR3JhcGguX2NvbnRhaW5zKHZlcnRleExpc3QsIHZlcnRleCkpXG4gICAgICAgICAgdGhpcy5hZGRWZXJ0ZXgodmVydGV4KVxuICAgICAgfVxuICAgIH0pXG4gIH1cblxuICBfYWRkTm90RXhpc3RpbmdWZXJ0aWNlc0Zyb21SZWxhdGlvbihfcmVsYXRpb24pIHtcbiAgICB0aGlzLl9hZGROb3RFeGlzdGluZ1ZlcnRpY2VzRnJvbUxpc3QoX3JlbGF0aW9uLnZlcnRleExpc3QxKVxuICAgIHRoaXMuX2FkZE5vdEV4aXN0aW5nVmVydGljZXNGcm9tTGlzdChfcmVsYXRpb24udmVydGV4TGlzdDIpXG4gIH1cblxufVxuXG5zcGluYWxDb3JlLnJlZ2lzdGVyX21vZGVscyhbR3JhcGhdKSJdfQ==